import json
import sys

signatures_to_find = ['antisandbox_sleep']
                    #['ransomware_extensions', 'ransomware_files', 'antivm_generic_cpu', 'antisandbox_cuckoo_files',
                    # 'antidebug_setunhandledexceptionfilter']

found_in_cuckoo = {}
found_in_cape = {}

with open(sys.argv[1], "r") as matching_signatures_file:
    samples = json.load(matching_signatures_file)
    for sample in samples:
        for signature in signatures_to_find:
            if signature in sample['cuckoo_signatures'] and signature not in sample['cape_signatures']:
                print("sha256: {} - signature {} found only in cuckoo_signatures".format(sample['sha256'], signature))
                if signature in found_in_cuckoo:
                    found_in_cuckoo[signature].append(sample['sha256'])
                else:
                    found_in_cuckoo[signature] = [sample['sha256']]
            elif signature in sample['cape_signatures'] and signature not in sample['cuckoo_signatures']:
                print("sha256: {} - signature {} found only in cape_signatures".format(sample['sha256'], signature))
                if signature in found_in_cape:
                    found_in_cape[signature].append(sample['sha256'])
                else:
                    found_in_cape[signature] = [sample['sha256']]

    print("Only found in Cuckoo: {}".format(found_in_cuckoo))
    print("Only found in Cape: {}".format(found_in_cape))
