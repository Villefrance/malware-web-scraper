# malware-web-scraper
## Gather data
## Step 0 - Setup
`python -m venv venv`
`source venv/bin/activate`
`pip install -r requirements.txt`
`playwright install`
May need:
`playwright install-deps`

### Scraping Cuckoo
#### Step 1 - Cuckoo Start
Optionally run `scrapy crawl cuckoo_start` once first to get the max/start id written to a .txt file called max_id.txt. Alternatively, this file can be created manually. It should contain the id from which you want the crawler to start from (it will then decrement this id by 1 to fetch additional reports).

`scrapy crawl cuckoo_start` --> max_id_cuckoo.txt






### Scraping Cape
#### Step x - Cape local spider
`scrapy crawl cape_local -a input_dir=~/malware-web-scraper/malware/reports/cape/html/ -o ~/malware-web-scraper/malware/reports/cape/json/cape_local1.json -s LOG_FILE=~/malware-web-scraper/malware/logs/cape_local1.log`

---

## Process data
### Step 0 - Install required python modules
`source venv/bin/activate`
`pip install -r requirements.txt`

### Step 1 - Unzip Cuckoo JSON reports
`python3 unzip_cuckoo_reports.py ~/malware-web-scraper/malware/reports/zip/ ~/malware-web-scraper/malware/reports/cuckoo/json/`

### Step 2 - Convert Cuckoo JSON reports to single file
`python3 convert_cuckoo_json_to_single_file.py ~/malware-web-scraper/malware/reports/cuckoo/json ~/malware-web-scraper/malware/reports/cuckoo/cuckoo_combined.json include_virustotal ~/malware-web-scraper/malware/reports/cuckoo/cuckoo_target_url_reports.pickle ~/malware-web-scraper/malware/reports/cuckoo/cuckoo_failed_reports.pickle`

### Step 3 - Check same hashes
`python3 check_same_hash.py ~/malware-web-scraper/malware/reports/cape/json/cape_local1.json ~/malware-web-scraper/malware/reports/cuckoo/cuckoo_combined.json ~/malware-web-scraper/malware/analysis/matching_hashes.json`
