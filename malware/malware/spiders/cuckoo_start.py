import scrapy
from scrapy_playwright.page import PageMethod

class CuckooStartSpider(scrapy.Spider):
	name = "cuckoo_start"
	allowed_domains = ["cuckoo.cert.ee"]

	def start_requests(self):
		yield scrapy.Request(
			url="https://cuckoo.cert.ee/analysis/",
			meta={
				"playwright": True,
				"playwright_page_methods": [
					PageMethod("wait_for_selector", "table#recent tbody tr td strong")
				]
			})

	def parse(self, response):
		with open('./max_id_cuckoo.txt', 'w') as max_id_file:
			max_id_file.write(response.css('table#recent tbody tr td strong::text').get())
