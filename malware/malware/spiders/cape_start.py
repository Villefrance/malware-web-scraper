import scrapy


class CapeStartSpider(scrapy.Spider):
	name = "cape_start"
	allowed_domains = ["capesandbox.com"]

	def start_requests(self):
		yield scrapy.Request("https://capesandbox.com/analysis/")

	def parse(self, response):
		with open('./max_id_cape.txt', 'w') as max_id_file:
			all_ids = response.css('.table.table-striped.table-sm tbody tr td:nth-child(1) a').getall()
			for id in all_ids:
				if "/analysis/" in id:
					max_id_file.write(id.split("/")[2]) # getting only the digits of the id
					break
